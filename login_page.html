<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="_csrf" content="MCmd4kM3ZgoI9_YMfN2ye5176Uog8o2elGLp5qVtO29N3wjFAx_7hiUDXzslk8Q4RPCGSq5DxCgYkL2zpQTQg5BfXgspvW2h"/>
    <meta name="_csrf_header" content="X-CSRF-TOKEN"/>
    <title>Iniciar Sesi√≥n | EcoVivaShop</title>
    
    <!-- Favicons -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png">
    
    <!-- CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <!-- EcoVivaShop Modern Theme - Sistema de Dise√±o Principal -->
    <link rel="stylesheet" href="/css/ecovivashop-theme.css">
    <!-- Client Styles -->
    <link rel="stylesheet" href="/css/client-styles.css">
    <!-- Navbar Dropdown Fix -->
    <link rel="stylesheet" href="/css/navbar-dropdown-fix.css">
    <!-- Dropdown Z-Index Fix - Soluci√≥n definitiva para dropdown detr√°s de elementos -->
    <link rel="stylesheet" href="/css/dropdown-z-index-fix.css">
    <!-- General Dropdown Fix - Soluci√≥n para dropdowns fuera del navbar -->
    <link rel="stylesheet" href="/css/general-dropdown-fix.css">
    <!-- User Dropdown Fix - Soluci√≥n para dropdown de usuario -->
    <link rel="stylesheet" href="/css/user-dropdown-fix.css">
    <!-- Simple Dropdown - Soluci√≥n simple y funcional -->
    <link rel="stylesheet" href="/css/simple-dropdown.css">
    <!-- Cart Badge Fix - Posicionamiento correcto del contador del carrito -->
    <link rel="stylesheet" href="/css/cart-badge-fix.css">
    
    <!-- JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Cart Test Script - Simulaci√≥n temporal del contador -->
    <script src="/js/cart-test.js"></script>
    
    <!-- OVERLAY CLEANUP SCRIPT - Previene capas semitransparentes que bloquean contenido -->
    <script>
        // Funci√≥n global para limpiar overlays residuales
        window.limpiarOverlaysResiduales = function() {
            console.log('üßπ [GLOBAL] Limpiando overlays residuales...');
            
            try {
                // Eliminar loadingOverlay din√°mico si existe
                const loadingOverlay = document.getElementById('loadingOverlay');
                if (loadingOverlay && loadingOverlay.parentNode) {
                    console.log('‚ùå [GLOBAL] Eliminando loadingOverlay residual');
                    loadingOverlay.parentNode.removeChild(loadingOverlay);
                }
                
                // Ocultar loadingIndicator est√°tico si est√° visible
                const loadingIndicator = document.getElementById('loadingIndicator');
                if (loadingIndicator) {
                    loadingIndicator.style.display = 'none';
                    console.log('‚ùå [GLOBAL] Ocultando loadingIndicator residual');
                }
                
                // Eliminar cualquier modal-backdrop residual de Bootstrap
                const modalBackdrops = document.querySelectorAll('.modal-backdrop');
                modalBackdrops.forEach(backdrop => {
                    if (backdrop && backdrop.parentNode) {
                        console.log('‚ùå [GLOBAL] Eliminando modal-backdrop residual');
                        backdrop.parentNode.removeChild(backdrop);
                    }
                });
                
                // Eliminar cualquier elemento con position fixed y alto z-index que pueda estar bloqueando
                const elementosFixed = document.querySelectorAll('[style*="position: fixed"], [style*="position:fixed"]');
                elementosFixed.forEach(elemento => {
                    const zIndex = window.getComputedStyle(elemento).zIndex;
                    if (zIndex && parseInt(zIndex) > 1000) {
                        // Solo eliminar si tiene z-index muy alto y parece ser un overlay
                        const background = window.getComputedStyle(elemento).background;
                        if (background && (background.includes('rgba') || background.includes('opacity') || background.includes('0.') || background.includes('0.5') || background.includes('0.6'))) {
                            console.log('‚ùå [GLOBAL] Eliminando elemento fixed con alto z-index y fondo semitransparente');
                            if (elemento.parentNode) {
                                elemento.parentNode.removeChild(elemento);
                            }
                        }
                    }
                });
                
                // Remover clase 'show' de cualquier modal que pueda estar abierto
                const modalsAbiertos = document.querySelectorAll('.modal.show');
                modalsAbiertos.forEach(modal => {
                    console.log('‚ùå [GLOBAL] Cerrando modal abierto residual');
                    try {
                        const bsModal = bootstrap.Modal.getInstance(modal);
                        if (bsModal) {
                            bsModal.hide();
                        } else {
                            modal.classList.remove('show');
                            modal.style.display = 'none';
                        }
                    } catch (e) {
                        // Fallback si Bootstrap no est√° disponible a√∫n
                        modal.classList.remove('show');
                        modal.style.display = 'none';
                    }
                });
                
                // RESTAURAR SCROLL DE LA P√ÅGINA - Bootstrap a√±ade overflow: hidden al body cuando abre modals
                if (document.body.classList.contains('modal-open')) {
                    document.body.classList.remove('modal-open');
                    console.log('‚ùå [GLOBAL] Removiendo clase modal-open del body');
                }
                
                // Restaurar overflow del body si est√° bloqueado
                const bodyOverflow = document.body.style.overflow;
                const htmlOverflow = document.documentElement.style.overflow;
                const bodyOverflowY = document.body.style.overflowY;
                const htmlOverflowY = document.documentElement.style.overflowY;
                
                if (bodyOverflow === 'hidden' || bodyOverflowY === 'hidden') {
                    document.body.style.overflow = '';
                    document.body.style.overflowY = '';
                    console.log('‚ùå [GLOBAL] Restaurando overflow del body');
                }
                
                if (htmlOverflow === 'hidden' || htmlOverflowY === 'hidden') {
                    document.documentElement.style.overflow = '';
                    document.documentElement.style.overflowY = '';
                    console.log('‚ùå [GLOBAL] Restaurando overflow del html');
                }
                
                console.log('‚úÖ [GLOBAL] Limpieza de overlays completada');
            } catch (error) {
                console.warn('‚ö†Ô∏è [GLOBAL] Error durante limpieza de overlays:', error);
            }
        };
        
        // Ejecutar limpieza cuando el DOM est√© listo
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() {
                window.limpiarOverlaysResiduales();
                setTimeout(window.limpiarOverlaysResiduales, 100);
                setTimeout(window.limpiarOverlaysResiduales, 500);
            });
        } else {
            // DOM ya est√° listo
            window.limpiarOverlaysResiduales();
            setTimeout(window.limpiarOverlaysResiduales, 100);
            setTimeout(window.limpiarOverlaysResiduales, 500);
        }
        
        // Tambi√©n ejecutar en window load por si acaso
        window.addEventListener('load', function() {
            setTimeout(window.limpiarOverlaysResiduales, 1000);
        });
    </script>
</head>
<body class="eco-bg">
    <nav class="navbar navbar-expand-lg eco-navbar-modern shadow-lg sticky-top">
    <div class="container">        <a class="navbar-brand d-flex align-items-center eco-brand-modern"
            href="/">
            <i class="bi bi-tree-fill me-2 fs-3 eco-text-white"></i>
            <span class="fw-bold fs-4 eco-text-white">EcoVivaShop</span>
        </a>
        
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" title="Abrir men√∫ de navegaci√≥n" aria-label="Abrir men√∫ de navegaci√≥n">
            <span class="navbar-toggler-icon"></span>
        </button>
        
        <div class="collapse navbar-collapse" id="navbarNav">            <!-- Enlaces para usuarios no autenticados -->
            <ul class="navbar-nav me-auto">
                <li class="nav-item">
                    <a class="nav-link" href="/">Inicio</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/productos">Productos</a>
                </li>
            </ul>
              <!-- Enlaces para clientes autenticados -->
            
              <!-- Enlaces para administradores -->
            
            
            <!-- Informaci√≥n del usuario autenticado -->
                        <!-- Enlaces para usuarios no autenticados -->
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" href="/auth/login">Iniciar Sesi√≥n</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link btn btn-success text-white ms-2 px-3" href="/auth/registro">Registrarse</a>
                </li>
            </ul>
        </div>
    </div>
</nav>
    <main class="container my-5">
        <div class="row justify-content-center">
            <div class="col-md-6 col-lg-5">
                <!-- Hero Card -->
                <div class="card shadow-lg border-0 rounded-4 mb-4" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white;">
                    <div class="card-body p-4 text-center">
                        <i class="bi bi-leaf-fill display-3 mb-3"></i>
                        <h1 class="fw-bold mb-2">EcoVivaShop</h1>
                        <p class="mb-0 opacity-75">Tu tienda sostenible de confianza</p>
                    </div>
                </div>

                <div class="card shadow-lg border-0 rounded-4" style="background: linear-gradient(135deg, #ffffff 0%, #f8fff8 100%);">
                    <div class="card-body p-4 p-md-5">
                        <div class="text-center mb-4">
                            <div class="bg-success bg-gradient rounded-circle d-inline-flex align-items-center justify-content-center mb-3" style="width: 80px; height: 80px;">
                                <i class="bi bi-person-circle text-white display-5"></i>
                            </div>
                            <h2 class="mt-3 mb-4 fw-bold text-success">Iniciar Sesi√≥n</h2>
                            <p class="text-muted">Accede a tu cuenta eco-sostenible</p>
                        </div><form action="/login" method="post" class="needs-validation" id="loginForm" novalidate><input type="hidden" name="_csrf" value="MCmd4kM3ZgoI9_YMfN2ye5176Uog8o2elGLp5qVtO29N3wjFAx_7hiUDXzslk8Q4RPCGSq5DxCgYkL2zpQTQg5BfXgspvW2h"/>
                            <input type="hidden" name="_csrf" value="MCmd4kM3ZgoI9_YMfN2ye5176Uog8o2elGLp5qVtO29N3wjFAx_7hiUDXzslk8Q4RPCGSq5DxCgYkL2zpQTQg5BfXgspvW2h" />
                            
                                                        <div class="input-group mb-3">
                                <span class="input-group-text border-success" style="background: linear-gradient(45deg, #e8f5e8, #f0f9f0);"><i class="bi bi-envelope text-success"></i></span>
                                <input type="email" class="form-control border-success" id="username" name="username" placeholder="Correo electr√≥nico" required style="background-color: #f8fff8;">
                            </div>
                            <div class="input-group mb-4 position-relative">
                                <span class="input-group-text border-success" style="background: linear-gradient(45deg, #e8f5e8, #f0f9f0);"><i class="bi bi-lock text-success"></i></span>
                                <input type="password" class="form-control border-success" id="password" name="password" placeholder="Contrase√±a" required minlength="4" style="background-color: #f8fff8;">
                                <button type="button" class="btn btn-outline-success border-success" id="togglePass" tabindex="-1"
                                        title="Mostrar/ocultar contrase√±a" aria-label="Mostrar u ocultar contrase√±a">
                                    <i class="bi bi-eye"></i>
                                </button>
                            </div>
                            <div class="d-grid gap-3">
                                <button type="submit" class="btn btn-lg shadow" style="background: linear-gradient(45deg, #28a745, #20c997); color: white; border: none; border-radius: 25px; font-weight: 600;">
                                    <i class="bi bi-box-arrow-in-right me-2"></i>Ingresar a EcoVivaShop
                                </button>
                                
                                <!-- Separador OAuth2 -->
                                <div class="text-center my-3">
                                    <span class="text-muted">o contin√∫a con</span>
                                </div>
                                
                                <!-- Bot√≥n Google OAuth2 -->
                                <a href="/oauth2/authorization/google" class="btn btn-lg btn-outline-danger d-flex align-items-center justify-content-center gap-2 shadow-sm" style="border-radius: 25px; font-weight: 600; transition: all 0.3s;">
                                    <svg width="18" height="18" viewBox="0 0 24 24">
                                        <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                                        <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                                        <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                                        <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                                    </svg>
                                    Continuar con Google
                                </a>
                                
                                <a href="/auth/registro" class="btn btn-outline-success btn-lg" style="border-radius: 25px; font-weight: 600;">
                                    <i class="bi bi-person-plus me-2"></i>Crear cuenta nueva
                                </a>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <footer class="eco-footer-improved">
    <div class="footer-wave">
        <svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120" preserveAspectRatio="none">
            <path d="M321.39,56.44c58-10.79,114.16-30.13,172-41.86,82.39-16.72,168.19-17.73,250.45-.39C823.78,31,906.67,72,985.66,92.83c70.05,18.48,146.53,26.09,214.34,3V0H0V27.35A600.21,600.21,0,0,0,321.39,56.44Z" class="shape-fill"></path>
        </svg>
    </div>
    
    <div class="footer-main">
        <div class="container">
            <div class="row g-4">
                <!-- Columna del Logo y Descripci√≥n -->
                <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="100">
                    <div class="footer-section">
                        <div class="footer-logo mb-3">
                            <i class="bi bi-tree-fill me-2 text-white"></i>
                            <span class="footer-brand">EcoVivaShop</span>
                        </div>
                        <p class="footer-description">
                            Tu socio en sostenibilidad. Transformamos el mundo un producto eco-friendly a la vez.
                        </p>
                        <!-- Mostrar estad√≠sticas solo en p√°ginas p√∫blicas -->
                        <div class="footer-stats">
                            <div class="stat-item">
                                <span class="stat-number">500+</span>
                                <span class="stat-label">Productos</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">1200+</span>
                                <span class="stat-label">Clientes</span>
                            </div>
                        </div>
                        <!-- Mensaje alternativo para p√°ginas de usuario -->
                        
                    </div>
                </div>
                
                <!-- Columna de Enlaces R√°pidos -->
                <div class="col-lg-2 col-md-6" data-aos="fade-up" data-aos-delay="200">
                    <div class="footer-section">
                        <h5 class="footer-title">Enlaces</h5>
                        <ul class="footer-links">
                            <li><a href="/"><i class="bi bi-house me-2"></i>Inicio</a></li>
                            <li><a href="/auth/registro"><i class="bi bi-person-plus me-2"></i>Registro</a></li>
                            <li><a href="/auth/login"><i class="bi bi-box-arrow-in-right me-2"></i>Login</a></li>
                            <li><a href="/client/home"><i class="bi bi-shop me-2"></i>Tienda</a></li>
                        </ul>
                    </div>
                </div>
                
                <!-- Columna de Informaci√≥n -->
                <div class="col-lg-3 col-md-6" data-aos="fade-up" data-aos-delay="300">
                    <div class="footer-section">
                        <h5 class="footer-title">Compromiso Verde</h5>
                        <div class="eco-features">
                            <div class="eco-feature">
                                <i class="bi bi-shield-check eco-text-primary"></i>
                                <span>100% Productos Certificados</span>
                            </div>
                            <div class="eco-feature">
                                <i class="bi bi-truck eco-text-primary"></i>
                                <span>Env√≠o Carbono Neutral</span>
                            </div>
                            <div class="eco-feature">
                                <i class="bi bi-recycle eco-text-primary"></i>
                                <span>Packaging Reciclable</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Columna de Redes Sociales -->
                <div class="col-lg-3 col-md-6" data-aos="fade-up" data-aos-delay="400">
                    <div class="footer-section">
                        <h5 class="footer-title">S√≠guenos</h5>
                        <p class="social-text">√önete a nuestra comunidad verde</p>
                        <div class="social-links">
                            <a href="https://www.facebook.com/" target="_blank" rel="noopener" class="social-btn facebook" title="Facebook">
                                <i class="bi bi-facebook"></i>
                            </a>
                            <a href="https://wa.me/" target="_blank" rel="noopener" class="social-btn whatsapp" title="WhatsApp">
                                <i class="bi bi-whatsapp"></i>
                            </a>
                            <a href="https://www.instagram.com/" target="_blank" rel="noopener" class="social-btn instagram" title="Instagram">
                                <i class="bi bi-instagram"></i>
                            </a>
                            <a href="https://m.me/" target="_blank" rel="noopener" class="social-btn messenger" title="Messenger">
                                <i class="bi bi-messenger"></i>
                            </a>
                        </div>
                        
                        <!-- Newsletter -->
                        <div class="newsletter-section mt-4">
                            <h6 class="newsletter-title">Newsletter Verde</h6>
                            <div class="newsletter-form">
                                <input type="email" placeholder="tu@email.com" class="newsletter-input">                                <button class="newsletter-btn" title="Suscribirse al newsletter">
                                    <i class="bi bi-send"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer Bottom -->
    <div class="footer-bottom">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <p class="copyright">
                        <i class="bi bi-c-circle me-1"></i>
                        2025 EcoVivaShop. Todos los derechos reservados.
                    </p>
                </div>
                <div class="col-md-6 text-md-end">
                    <div class="footer-badges">
                        <span class="eco-badge">
                            <i class="bi bi-award-fill me-1"></i>Certificado Verde
                        </span>
                        <span class="eco-badge">
                            <i class="bi bi-leaf-fill me-1"></i>100% Ecol√≥gico
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        (() => {
            'use strict';
            const form = document.getElementById('loginForm');
            form.addEventListener('submit', event => {
                if (!form.checkValidity()) {
                    event.preventDefault();
                    event.stopPropagation();
                }
                form.classList.add('was-validated');
            });
            const togglePass = document.getElementById('togglePass');
            const passInput = document.getElementById('password');
            togglePass.addEventListener('click', () => {
                const type = passInput.type === 'password' ? 'text' : 'password';
                passInput.type = type;
                togglePass.querySelector('i').classList.toggle('bi-eye');
                togglePass.querySelector('i').classList.toggle('bi-eye-slash');
            });
        })();
    </script>
    <style>
        .eco-login-card {
            transition: box-shadow 0.3s, transform 0.3s;
            box-shadow: 0 4px 24px rgba(44, 62, 80, 0.10);
        }
        .eco-login-card:hover {
            box-shadow: 0 8px 32px rgba(44, 62, 80, 0.15);
            transform: translateY(-4px) scale(1.03);
        }
        .eco-btn-login {
            background: linear-gradient(90deg, #43a047 0%, #388e3c 100%);
            border: none;
            transition: background 0.2s, box-shadow 0.2s, transform 0.1s;
        }
        .eco-btn-login:active {
            transform: scale(0.98);
        }
        .eco-btn-login:hover {
            background: linear-gradient(90deg, #388e3c 0%, #43a047 100%);
            box-shadow: 0 2px 8px rgba(44, 62, 80, 0.10);
        }
        .input-group-text {
            background: #f4fbf6;
            border-right: 0;
        }
        .form-control:focus {
            box-shadow: none;
        }
        .input-group .form-control {
            border-left: 0;
        }
    </style>
</body>
</html>
